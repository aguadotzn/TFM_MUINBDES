source('~/Desktop/Code/extra/temperaturas_mundiales_animacion.R', echo=TRUE)
install.packages("tidyverse")
source('~/Desktop/Code/extra/temperaturas_mundiales_animacion.R', echo=TRUE)
install.packages("gganimate")
install.packages("ggrepel")
install.packages("ggthemes")
source('~/Desktop/Code/extra/temperaturas_mundiales_animacion.R', echo=TRUE)
source('~/Desktop/Code/extra/temperaturas_mundiales_animacion.R', echo=TRUE)
# Add data
co2 <- readr::read_csv("https://gist.github.com/aguadotzn/63172ea2ce9fec3649568678e5fdc6e5")
View(co2)
# Add data
co2 <- readr::read_csv("https://gist.githubusercontent.com/aguadotzn/63172ea2ce9fec3649568678e5fdc6e5/raw/820f769c1152b041ded62c9f7af47b078e51a945/co2worlddata")
View(co2)
# Save animation
anim_save('co2.gif')
# Load libraries
library(tidyverse)
#-------------------------------------------------------------------
# MUINBDES_TFM_CALIDAD_AIRE_MADRID¶
# Autor: Adrián Aguado
# Fecha: Agosto 2019
# Descripción: Animacion para apoyo de la web sobre
# Nombre file: temperaturas_mundiales_animacion
# Fuente datos:
#-------------------------------------------------------------------
# Load libraries
library(tidyverse)
library(gganimate)
library(ggrepel)
library(ggthemes)
# Add data
co2 <- readr::read_csv("https://gist.githubusercontent.com/aguadotzn/63172ea2ce9fec3649568678e5fdc6e5/raw/820f769c1152b041ded62c9f7af47b078e51a945/co2worlddata")
# Group data by mean
co2_summary <- co2 %>%
group_by(anio) %>%
summarise(mean_emision = mean(emision_co2, na.rm = TRUE))
# Create animation
anim <- co2_summary %>%
ggplot(aes(x = anio,
y = mean_emision,
color = mean_emision,
# size = mean_emision,
label = paste('año: ', anio,
'\nemision: ',
round(mean_emision,1) ))) +
geom_line(size = 1) +
geom_point(size = 3) +
geom_label_repel(direction = 'x',
vjust = 1,
nudge_y = 2,
size = 5) +
ylim(0,8) +
xlim(1960, 2020) +
scale_color_gradient(low="blue", high="red") +
coord_polar() +
labs(title = 'Cada año emitimos más CO2',
x = 'años (de 1960 a 2020)',
y = 'Emisión CO2 (toneladas métricas per cápita)',
color = 'Emisión') +
theme_gdocs() +
transition_reveal(anio) +
NULL
# animando
animate(anim,
fps = 50,
# si quieres cambiar el tamaño en pixeles
# width = 1600,
# height = 1200,
nframes = 500,
end_pause = 100)
# Save animation
anim_save('co2.gif')
getwd()
install.packages("WDI")
install.packages("patchwork")
source('~/Desktop/Code/extra/emisiones_co2.R', echo=TRUE)
install.packages("patchwork")
source('~/Desktop/Code/extra/emisiones_co2.R')
source('~/Desktop/Code/extra/emisiones_co2.R', echo=TRUE)
ggsave("CO2.png", todos, height=9, width=18)
todos <- plot_grid(gr, g3, nrow=1)
ggsave("CO2.png", todos, height=9, width=18)
source('~/Desktop/Code/extra/emisiones_co2.R', echo=TRUE)
install.packages("extrafont")
source('~/Desktop/Code/extra/emisiones_co2.R', echo=TRUE)
install.packages("cowplot")
source('~/Desktop/Code/extra/emisiones_co2.R', echo=TRUE)
source('~/Desktop/Code/extra/emisiones_co2.R', echo=TRUE)
g2 <- co2_ingreso_filtrada_2 %>% filter(anio==1960 | anio==1970 | anio==1980 |
anio==1990 | anio==2000 | anio==2010) %>%
ggplot(aes(x=anio, y=porcentaje_co2, fill=grupo_ok, label=round(porcentaje_co2))) +
geom_bar(stat="identity", position="stack") +
geom_text(position=position_stack(vjust=0.5), size=3) +
scale_fill_brewer("Grupo de países según ingreso", palette="Set1",
limits=c("Ingreso alto",
"Ingreso medio alto",
"Ingreso medio bajo",
"Ingreso bajo")) +
theme_minimal() +
theme_graficos +
scale_x_continuous(breaks=c(1960,1970,1980,1990,2000,2010)) +
labs(x="Año",
y="Porcentaje del total de emisiones de CO2",
title="Distribución de las emisiones de CO2 por países agrupados por ingreso",
subtitle="Porcentaje sobre el total de emisiones. 1960-2010",
caption="") +
theme(legend.position="bottom")
#-------------------------------------------------------------------
# MUINBDES_TFM_CALIDAD_AIRE_MADRID¶
# Autor: Adrián Aguado
# Fecha: Agosto 2019
# Descripción: Animacion para apoyo en la web sobre emisiones CO2 mundiales
# Nombre file: emisiones_mundiales_co2_animacion
# Fuente datos: https://datos.bancomundial.org/indicador/EN.ATM.CO2E.PC
#-------------------------------------------------------------------
library(tidyverse)
library(extrafont)
library(extrafontdb)
library(RColorBrewer)
library(cowplot)
co2 <- readr::read_csv("https://raw.githubusercontent.com/cienciadedatos/datos-de-miercoles/master/datos/2019/2019-08-21/co2.csv")
co2_ingreso <- readr::read_csv("https://raw.githubusercontent.com/cienciadedatos/datos-de-miercoles/master/datos/2019/2019-08-21/co2_ingreso.csv")
co2_ingreso_filtrada <- co2_ingreso %>% filter(grupo=="Ingreso alto"|
grupo=="Ingreso bajo"|
grupo=="Ingreso medio-altos" |
grupo=="Ingreso medio-bajo") %>%
mutate(grupo_ok=ifelse(grupo=="Ingreso medio-altos", "Ingreso medio alto",
ifelse(grupo=="Ingreso medio-bajo", "Ingreso medio bajo",
grupo)))
theme_graficos <- theme(title=element_text(face="bold", size=14),
axis.title=element_text(face="bold", size=12),
axis.text=element_text(size=11),
legend.title=element_text(size=12, face="bold"),
legend.text=element_text(size=12))
g <- ggplot(co2_ingreso_filtrada, aes(x=anio, y=emision_co2, col=grupo_ok)) +
geom_line(position="identity", size=1.2) +
theme_minimal() +
labs(x="",
y="Emisión CO2",
title="Emisiones de CO2 por año y países agrupados por ingreso",
subtitle="Toneladas métricas per cápita (millones). 1960-2014") +
scale_color_brewer("Grupo de países según ingreso", palette="Set1",
limits=c("Ingreso alto",
"Ingreso medio alto",
"Ingreso medio bajo",
"Ingreso bajo")) +
scale_x_continuous(breaks=c(1960, 1970,1980,1990,2000,2010)) +
theme_graficos +
theme(legend.position="")
co2_total <- aggregate(emision_co2~anio, co2_ingreso_filtrada, sum)
co2_ingreso_filtrada_2 <- co2_ingreso_filtrada %>% left_join(co2_total, by="anio") %>%
mutate(porcentaje_co2=emision_co2.x/emision_co2.y*100)
g2 <- co2_ingreso_filtrada_2 %>% filter(anio==1960 | anio==1970 | anio==1980 |
anio==1990 | anio==2000 | anio==2010) %>%
ggplot(aes(x=anio, y=porcentaje_co2, fill=grupo_ok, label=round(porcentaje_co2))) +
geom_bar(stat="identity", position="stack") +
geom_text(position=position_stack(vjust=0.5), size=3) +
scale_fill_brewer("Grupo de países según ingreso", palette="Set1",
limits=c("Ingreso alto",
"Ingreso medio alto",
"Ingreso medio bajo",
"Ingreso bajo")) +
theme_minimal() +
theme_graficos +
scale_x_continuous(breaks=c(1960,1970,1980,1990,2000,2010)) +
labs(x="Año",
y="Porcentaje del total de emisiones de CO2",
title="Distribución de las emisiones de CO2 por países agrupados por ingreso",
subtitle="Porcentaje sobre el total de emisiones. 1960-2010",
caption="") +
theme(legend.position="bottom")
g3 <- co2 %>% arrange(-emision_co2)%>%
filter(anio==2014) %>%
head(20) %>%
ggplot(aes(x=reorder(pais_region, emision_co2), y=emision_co2)) +
coord_flip() +
geom_point(color="sienna", size=5) +
geom_density(stat="identity", color="black", size=0.1) +
theme_minimal() +
theme_graficos +
labs(y="Emisión CO2",
x="País",
title="20 países con mayor emisión de CO per cápita en 2014",
subtitle="Toneladas métricas per cápita (millones)")
gr <- plot_grid(g, g2, nrow=2)
todos <- plot_grid(gr, g3, nrow=1)
ggsave("CO2.png", todos, height=9, width=18)
#-------------------------------------------------------------------
# MUINBDES_TFM_CALIDAD_AIRE_MADRID¶
# Autor: Adrián Aguado
# Fecha: Agosto 2019
# Descripción: Animacion para apoyo en la web sobre emisiones CO2 mundiales
# Nombre file: emisiones_mundiales_co2_animacion
# Fuente datos: https://datos.bancomundial.org/indicador/EN.ATM.CO2E.PC
#-------------------------------------------------------------------
library(tidyverse)
library(extrafont)
library(extrafontdb)
library(RColorBrewer)
library(cowplot)
co2 <- readr::read_csv("https://raw.githubusercontent.com/cienciadedatos/datos-de-miercoles/master/datos/2019/2019-08-21/co2.csv")
co2_ingreso <- readr::read_csv("https://raw.githubusercontent.com/cienciadedatos/datos-de-miercoles/master/datos/2019/2019-08-21/co2_ingreso.csv")
co2_ingreso_filtrada <- co2_ingreso %>% filter(grupo=="Ingreso alto"|
grupo=="Ingreso bajo"|
grupo=="Ingreso medio-altos" |
grupo=="Ingreso medio-bajo") %>%
mutate(grupo_ok=ifelse(grupo=="Ingreso medio-altos", "Ingreso medio alto",
ifelse(grupo=="Ingreso medio-bajo", "Ingreso medio bajo",
grupo)))
theme_graficos <- theme(title=element_text(face="bold", size=14),
axis.title=element_text(face="bold", size=12),
axis.text=element_text(size=11),
legend.title=element_text(size=12, face="bold"),
legend.text=element_text(size=12))
g <- ggplot(co2_ingreso_filtrada, aes(x=anio, y=emision_co2, col=grupo_ok)) +
geom_line(position="identity", size=1.2) +
theme_minimal() +
labs(x="",
y="Emisión CO2",
title="Emisiones de CO2 por año y países agrupados por ingreso",
subtitle="Toneladas métricas per cápita (millones). 1960-2014") +
scale_color_brewer("Grupo de países según ingreso", palette="Set1",
limits=c("Ingreso alto",
"Ingreso medio alto",
"Ingreso medio bajo",
"Ingreso bajo")) +
scale_x_continuous(breaks=c(1960, 1970,1980,1990,2000,2010)) +
theme_graficos +
theme(legend.position="")
co2_total <- aggregate(emision_co2~anio, co2_ingreso_filtrada, sum)
co2_ingreso_filtrada_2 <- co2_ingreso_filtrada %>% left_join(co2_total, by="anio") %>%
mutate(porcentaje_co2=emision_co2.x/emision_co2.y*100)
g2 <- co2_ingreso_filtrada_2 %>% filter(anio==1960 | anio==1970 | anio==1980 |
anio==1990 | anio==2000 | anio==2010) %>%
ggplot(aes(x=anio, y=porcentaje_co2, fill=grupo_ok, label=round(porcentaje_co2))) +
geom_bar(stat="identity", position="stack") +
geom_text(position=position_stack(vjust=0.5), size=3) +
scale_fill_brewer("Grupo de países según ingreso", palette="Set1",
limits=c("Ingreso alto",
"Ingreso medio alto",
"Ingreso medio bajo",
"Ingreso bajo")) +
theme_minimal() +
theme_graficos +
scale_x_continuous(breaks=c(1960,1970,1980,1990,2000,2010)) +
labs(x="Año",
y="Porcentaje del total de emisiones de CO2",
title="Distribución de las emisiones de CO2 por países agrupados por ingreso",
subtitle="Porcentaje sobre el total de emisiones. 1960-2010",
caption="") +
theme(legend.position="bottom")
g3 <- co2 %>% arrange(-emision_co2)%>%
filter(anio==2014) %>%
head(20) %>%
ggplot(aes(x=reorder(pais_region, emision_co2), y=emision_co2)) +
coord_flip() +
geom_point(color="sienna", size=5) +
geom_density(stat="identity", color="black", size=0.1) +
theme_minimal() +
theme_graficos +
labs(y="Emisión CO2",
x="País",
title="20 países con mayor emisión de CO per cápita en 2014",
subtitle="Toneladas métricas per cápita (millones)")
#gr <- plot_grid(g, g2, nrow=2)
#todos <- plot_grid(gr, g3, nrow=1)
ggsave("CO21.png", gr, height=9, width=18)
ggsave("CO22.png", g3, height=9, width=18)
ggsave("CO23.png", g2, height=9, width=18)
#-------------------------------------------------------------------
# MUINBDES_TFM_CALIDAD_AIRE_MADRID¶
# Autor: Adrián Aguado
# Fecha: Agosto 2019
# Descripción: Gráficas para apoyo en la web sobre emisiones CO2 mundiales
# Nombre file: emisiones_mundiales_co2
# Fuente datos: https://datos.bancomundial.org/indicador/EN.ATM.CO2E.PC
#-------------------------------------------------------------------
#Load libraries
library(tidyverse)
library(extrafont)
library(extrafontdb)
library(RColorBrewer)
library(cowplot)
#Read files
co2 <- readr::read_csv("https://gist.githubusercontent.com/aguadotzn/63172ea2ce9fec3649568678e5fdc6e5/raw/820f769c1152b041ded62c9f7af47b078e51a945/co2worlddata")
co2_ingreso <- readr::read_csv("https://gist.githubusercontent.com/aguadotzn/d19095f85c750478f0b61b9b7b75f135/raw/65e8d04a5536e7e6e9c81d1f839413453ddb1a61/co2_income")
#Filter data
co2_ingreso_filtrada <- co2_ingreso %>% filter(grupo=="Ingreso alto"|
grupo=="Ingreso bajo"|
grupo=="Ingreso medio-altos" |
grupo=="Ingreso medio-bajo") %>%
mutate(grupo_ok=ifelse(grupo=="Ingreso medio-altos", "Ingreso medio alto",
ifelse(grupo=="Ingreso medio-bajo", "Ingreso medio bajo",
grupo)))
#Create graphics
theme_graficos <- theme(title=element_text(face="bold", size=14),
axis.title=element_text(face="bold", size=12),
axis.text=element_text(size=11),
legend.title=element_text(size=12, face="bold"),
legend.text=element_text(size=12))
g <- ggplot(co2_ingreso_filtrada, aes(x=anio, y=emision_co2, col=grupo_ok)) +
geom_line(position="identity", size=1.2) +
theme_minimal() +
labs(x="",
y="Emisión CO2",
title="Emisiones de CO2 por año y países agrupados por ingreso",
subtitle="Toneladas métricas per cápita (millones). 1960-2014") +
scale_color_brewer("Grupo de países según ingreso", palette="Set1",
limits=c("Ingreso alto",
"Ingreso medio alto",
"Ingreso medio bajo",
"Ingreso bajo")) +
scale_x_continuous(breaks=c(1960, 1970,1980,1990,2000,2010)) +
theme_graficos +
theme(legend.position="")
co2_total <- aggregate(emision_co2~anio, co2_ingreso_filtrada, sum)
co2_ingreso_filtrada_2 <- co2_ingreso_filtrada %>% left_join(co2_total, by="anio") %>%
mutate(porcentaje_co2=emision_co2.x/emision_co2.y*100)
g2 <- co2_ingreso_filtrada_2 %>% filter(anio==1960 | anio==1970 | anio==1980 |
anio==1990 | anio==2000 | anio==2010) %>%
ggplot(aes(x=anio, y=porcentaje_co2, fill=grupo_ok, label=round(porcentaje_co2))) +
geom_bar(stat="identity", position="stack") +
geom_text(position=position_stack(vjust=0.5), size=3) +
scale_fill_brewer("Grupo de países según ingreso", palette="Set1",
limits=c("Ingreso alto",
"Ingreso medio alto",
"Ingreso medio bajo",
"Ingreso bajo")) +
theme_minimal() +
theme_graficos +
scale_x_continuous(breaks=c(1960,1970,1980,1990,2000,2010)) +
labs(x="Año",
y="Porcentaje del total de emisiones de CO2",
title="Distribución de las emisiones de CO2 por países agrupados por ingreso",
subtitle="Porcentaje sobre el total de emisiones. 1960-2010",
caption="") +
theme(legend.position="bottom")
g3 <- co2 %>% arrange(-emision_co2)%>%
filter(anio==2014) %>%
head(20) %>%
ggplot(aes(x=reorder(pais_region, emision_co2), y=emision_co2)) +
coord_flip() +
geom_point(color="sienna", size=5) +
geom_density(stat="identity", color="black", size=0.1) +
theme_minimal() +
theme_graficos +
labs(y="Emisión CO2",
x="País",
title="20 países con mayor emisión de CO per cápita en 2014",
subtitle="Toneladas métricas per cápita (millones)")
#gr <- plot_grid(g, g2, nrow=2)
#todos <- plot_grid(gr, g3, nrow=1)
ggsave("CO21.png", gr, height=9, width=18)
ggsave("CO22.png", g3, height=9, width=18)
ggsave("CO23.png", g2, height=9, width=18)
#-------------------------------------------------------------------
# MUINBDES_TFM_CALIDAD_AIRE_MADRID¶
# Autor: Adrián Aguado
# Fecha: Agosto 2019
# Descripción: Gráficas para apoyo en la web sobre emisiones CO2 mundiales
# Nombre file: emisiones_mundiales_co2
# Fuente datos: https://datos.bancomundial.org/indicador/EN.ATM.CO2E.PC
#-------------------------------------------------------------------
#Load libraries
library(tidyverse)
library(extrafont)
library(extrafontdb)
library(RColorBrewer)
library(cowplot)
#Read files
co2 <- readr::read_csv("https://gist.githubusercontent.com/aguadotzn/63172ea2ce9fec3649568678e5fdc6e5/raw/820f769c1152b041ded62c9f7af47b078e51a945/co2worlddata")
co2_ingreso <- readr::read_csv("https://gist.githubusercontent.com/aguadotzn/d19095f85c750478f0b61b9b7b75f135/raw/65e8d04a5536e7e6e9c81d1f839413453ddb1a61/co2_income")
#Filter data
co2_ingreso_filtrada <- co2_ingreso %>% filter(grupo=="Ingreso alto"|
grupo=="Ingreso bajo"|
grupo=="Ingreso medio-altos" |
grupo=="Ingreso medio-bajo") %>%
mutate(grupo_ok=ifelse(grupo=="Ingreso medio-altos", "Ingreso medio alto",
ifelse(grupo=="Ingreso medio-bajo", "Ingreso medio bajo",
grupo)))
#Create graphics
theme_graficos <- theme(title=element_text(face="bold", size=14),
axis.title=element_text(face="bold", size=12),
axis.text=element_text(size=11),
legend.title=element_text(size=12, face="bold"),
legend.text=element_text(size=12))
#PLOT 1
g <- ggplot(co2_ingreso_filtrada, aes(x=anio, y=emision_co2, col=grupo_ok)) +
geom_line(position="identity", size=1.2) +
theme_minimal() +
labs(x="",
y="Emisión CO2",
title="Emisiones de CO2 por año y países agrupados por ingreso",
subtitle="Toneladas métricas per cápita (millones). 1960-2014") +
scale_color_brewer("Grupo de países según ingreso", palette="Set1",
limits=c("Ingreso alto",
"Ingreso medio alto",
"Ingreso medio bajo",
"Ingreso bajo")) +
scale_x_continuous(breaks=c(1960, 1970,1980,1990,2000,2010)) +
theme_graficos +
theme(legend.position="")
co2_total <- aggregate(emision_co2~anio, co2_ingreso_filtrada, sum)
co2_ingreso_filtrada_2 <- co2_ingreso_filtrada %>% left_join(co2_total, by="anio") %>%
mutate(porcentaje_co2=emision_co2.x/emision_co2.y*100)
g2 <- co2_ingreso_filtrada_2 %>% filter(anio==1960 | anio==1970 | anio==1980 |
anio==1990 | anio==2000 | anio==2010) %>%
ggplot(aes(x=anio, y=porcentaje_co2, fill=grupo_ok, label=round(porcentaje_co2))) +
geom_bar(stat="identity", position="stack") +
geom_text(position=position_stack(vjust=0.5), size=3) +
scale_fill_brewer("Grupo de países según ingreso", palette="Set1",
limits=c("Ingreso alto",
"Ingreso medio alto",
"Ingreso medio bajo",
"Ingreso bajo")) +
theme_minimal() +
theme_graficos +
scale_x_continuous(breaks=c(1960,1970,1980,1990,2000,2010)) +
labs(x="Año",
y="Porcentaje del total de emisiones de CO2",
title="Distribución de las emisiones de CO2 por países agrupados por ingreso",
subtitle="Porcentaje sobre el total de emisiones. 1960-2010",
caption="") +
theme(legend.position="bottom")
g3 <- co2 %>% arrange(-emision_co2)%>%
filter(anio==2014) %>%
head(20) %>%
ggplot(aes(x=reorder(pais_region, emision_co2), y=emision_co2)) +
coord_flip() +
geom_point(color="sienna", size=5) +
geom_density(stat="identity", color="black", size=0.1) +
theme_minimal() +
theme_graficos +
labs(y="Emisión CO2",
x="País",
title="20 países con mayor emisión de CO per cápita en 2014",
subtitle="Toneladas métricas per cápita (millones)")
#gr <- plot_grid(g, g2, nrow=2)
#todos <- plot_grid(gr, g3, nrow=1)
ggsave("CO21.png", gr, height=9, width=18)
ggsave("CO22.png", g3, height=9, width=18)
